var db=require("../../models"),passport=require("../../config/passport");const isAuthenticated=require("../../config/middleware/isAuthenticated");module.exports=function(a){a.post("/api/login",passport.authenticate("local"),function(a,b){b.json(a.user)}),a.post("/api/signup",function(a,b){db.User.create({email:a.body.email,password:a.body.password,firstName:a.body.firstName,lastName:a.body.lastName}).then(function(){console.log("it worked"),b.redirect("/login")}).catch(function(a){console.log("it didn't"),b.status(401).json(a)})}),a.get("/logout",function(a,b){a.logout(),b.redirect("/")}),a.get("/api/user_data",function(a,b){a.user?b.json({email:a.user.email,id:a.user.id}):b.json({})}),a.get("/api/goals/",function(a,b){db.Goal.findAll({where:{email:a.user.email},raw:!0}).then(function(a){console.log(a),b.json(a)})}),a.post("/api/goals",isAuthenticated,function(a,b){console.log(a.body),console.log(a.user.email),db.Goal.create({goalSetByUser:a.body.goal,email:a.user.email}).then(function(){b.redirect("/goals")})}),a.post("/api/goals",function(a,b){console.log(a.body),console.log(a.user.email),db.Goal.create({goalSetByUser:a.body.goal,email:a.user.email}).then(function(a){b.json(a)})}),a.post("/api/goals/:id",function(a,b){console.log(a.body),db.Goal.update({completed:a.body.completed},{where:{id:a.params.id}}).then(function(){b.redirect("/goals")}).catch(function(a){console.log(a),b.redirect("/goals")})}),a.post("/api/workout/cardio",function(a,b){console.log(a.body),db.Workout.create({workout_type:"Cardio",email:a.user.email,exercise_name:a.body.exercise_name,distance:a.body.distance,time_workout:a.body.time_workout}).then(function(a){b.json(a)})}),a.post("/api/workout/bodyweight",function(a,b){console.log(a.body),db.Workout.create({workout_type:"Bodyweight",email:a.user.email,exercise_name:a.body.exercise_name,time_workout:a.body.time_workout,reps:a.body.reps,sets:a.body.sets}).then(function(a){b.json(a)})}),a.post("/api/workout/weightlifting",function(a,b){console.log(a.body),db.Workout.create({workout_type:"Weightlifting",email:a.user.email,exercise_name:a.body.exercise_name,reps:a.body.reps,sets:a.body.sets,weight_lifted:a.body.weight_lifted}).then(function(a){b.json(a)})}),a.get("/api/BMI",function(a,b){db.Bmi.findAll({where:{email:a.user.email}}).then(function(a){b.json(a)})}),a.post("/api/BMI",function(a,b){db.Bmi.create({height:a.body.height,weight:a.body.weight,bmi:a.body.bmi,email:a.user.email}).then(function(a){b.json(a)})}),a.delete("/api/BMI/:id",function(a,b){db.Bmi.destroy({where:{id:a.params.id}}).then(function(a){b.json(a)})})};